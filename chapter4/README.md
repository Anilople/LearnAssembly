# 深入理解计算机系统 - 第4章(处理器体系结构)

### 为什么要学这章?

* 有趣, 重要
* 理解处理器如何工作能帮助理解整个计算机系统如何工作
* 虽然很少有人设计处理器, 但是很多人设计包含处理器的硬件系统
* 你的工作可能就是处理器设计

## Y86-64指令集体系结构

15个寄存器`%rax,%rbx,%rcx,%rdx,%rsp,%rbp,%rsi,%rdi,%r8 ~ %r14`

3个flag标志位`ZF,SF,OF`

基本上是x86-64指令集的一个子集, 只包括8字节整数操作, 寻址方式和操作少.

#### 指令细节

* movq系列. `irmovq,rrmovq,mrmovq,rmmovq`.源可以是立即数(i), 寄存器(r)和内存(m). 目的可以是寄存器(r)和内存(m). 第1个字母代表源的类型, 第2个字母代表目的的类型.
* 4个整数操作指令. `addq, subq, andq, xorq`, 只能对寄存器数据进行操作.
* 7个跳转指令. `jXX`系列. `jmp, jle, jl, je, jne, jge, jg`
* 6个条件传送指令, `comvXX`系列. `comvle,  cmovl, cmove, cmovne, cmovge, cmovg`
* `call, ret`
* `pushq, popq`和x86-64一致
* `halt`指令停止指令的执行, 并将状态吗设置为HLT

指令编码

每条指令需要1~10个字节不等, 每条指令的第1个字节表明指令的类型, 这个字节分为2部分: 高4位是代码(code)部分, 低4位是功能(function)部分.